!function(e){var t,_,o,n,a,r,d,u,i,l,m,p,s,c,x,h,v,f=e.event.special,g={},b=!1,y=-1,w="ue_bound",z=!1,S={bound_ns_map:{},px_radius:10,ignore_select:"",max_tap_ms:200,min_held_ms:300},E=[],k=1,X=4;u=function(e){var t,_=0;for(t=this.length;t;0)this[--t]===e&&_++;return _},i=function(e){var t,_=0;for(t=this.length;t;0)this[--t]===e&&(this.splice(t,1),_++,t++);return _},l=function(e){return u.call(this,e)?!1:(this.push(e),!0)},m=function(t){if(t&&e.isArray(t)){if(t.remove_val)return t}else t=[];return t.remove_val=i,t.match_val=u,t.push_uniq=l,t},t=m(),_={setup:function(_,o,n){var a,r,d,u,i,l=this,p=e(l),s={};if(!e.data(this,w)){for(a={},e.extend(!0,a,S),e.data(l,w,a),i=m(o.slice(0)),i.length&&""!==i[0]||(i=["000"]),r=0;r<i.length;r++)d=i[r],d&&(s.hasOwnProperty(d)||(s[d]=!0,u=".__ue"+d,p.on("mousedown"+u,h),p.on("touchstart"+u,v)));t.push_uniq(l),b||(e(document).on("mousemove.__ue",h),e(document).on("touchmove.__ue",v),e(document).on("mouseup.__ue",h),e(document).on("touchend.__ue",v),e(document).on("touchcancel.__ue",v),b=!0)}},add:function(t){var _,o,n,a,r=this,d=e.data(r,w),u=t.namespace,i=t.type;if(d&&(_=d.bound_ns_map,_[i]||(_[i]={}),u))for(o=u.split("."),n=0;n<o.length;n++)a=o[n],_[i][a]=!0},remove:function(t){var _,o,n,a=this,r=e.data(a,w),d=r.bound_ns_map,u=t.type,i=t.namespace;if(d[u]){if(!i)return void delete d[u];for(_=i.split("."),o=0;o<_.length;o++)n=_[o],d[u][n]&&delete d[u][n];e.isEmptyObject(d[u])&&delete d[u]}},teardown:function(_){var o,n,a,r,d=this,u=e(d),i=e.data(d,w),l=i.bound_ns_map;if(e.isEmptyObject(l)){for(r=m(_),r.push_uniq("000"),o=0;o<r.length;o++)n=r[o],n&&(a=".__ue"+n,u.off("mousedown"+a),u.off("touchstart"+a),u.off("mousewheel"+a));e.removeData(d,w),t.remove_val(this),0===t.length&&(e(document).off("mousemove.__ue"),e(document).off("touchmove.__ue"),e(document).off("mouseup.__ue"),e(document).off("touchend.__ue"),e(document).off("touchcancel.__ue"),b=!1)}}},p=function(t){var _,o=+new Date,a=t.motion_id,r=t.motion_map,d=t.bound_ns_map;delete r.tapheld_toid,r.do_allow_held&&(r.px_end_x=r.px_start_x,r.px_end_y=r.px_start_y,r.ms_timestop=o,r.ms_elapsed=o-r.ms_timestart,d.uheld&&(_=e.Event("uheld"),e.extend(_,r),e(r.elem_bound).trigger(_)),d.uheldstart?(_=e.Event("uheldstart"),e.extend(_,r),e(r.elem_bound).trigger(_),n=a):delete g[a])},s=function(t){var _,o,n,u=t.motion_id,i=t.event_src,l=t.request_dzoom,m=e.data(t.elem,w),s=m.bound_ns_map,c=e(i.target),x=!1;if(!g[u]&&(!l||s.uzoomstart)&&!c.is(m.ignore_select)){for(i.preventDefault(),o=E.pop();o;)c.is(o.selector_str)||e(t.elem).is(o.selector_str)?o.callback_match&&o.callback_match(t):o.callback_nomatch&&o.callback_nomatch(t),o=E.pop();return _={do_allow_tap:s.utap?!0:!1,do_allow_held:s.uheld||s.uheldstart?!0:!1,elem_bound:t.elem,elem_target:i.target,ms_elapsed:0,ms_timestart:i.timeStamp,ms_timestop:void 0,option_map:m,orig_target:i.target,px_current_x:i.clientX,px_current_y:i.clientY,px_end_x:void 0,px_end_y:void 0,px_start_x:i.clientX,px_start_y:i.clientY,timeStamp:i.timeStamp,px_center_x:void 0,px_center_y:void 0},g[u]=_,s.uzoomstart&&(l?a=u:r?d||(d=u,n=e.Event("uzoomstart"),x=!0):r=u,x)?(n=e.Event("uzoomstart"),_.px_delta_zoom=0,e.extend(n,_),void e(_.elem_bound).trigger(n)):void((s.uheld||s.uheldstart)&&(_.tapheld_toid=setTimeout(function(){p({motion_id:u,motion_map:_,bound_ns_map:s})},m.min_held_ms)))}},c=function(t){var _,u,i,l,m,p,s,c,x,h,v,f=t.motion_id,b=t.event_src,w=!1;if(g[f])return b.preventDefault(),_=g[f],u=_.option_map,i=u.bound_ns_map,_.timeStamp=b.timeStamp,_.elem_target=b.target,_.ms_elapsed=b.timeStamp-_.ms_timestart,_.px_delta_x=b.clientX-_.px_current_x,_.px_delta_y=b.clientY-_.px_current_y,_.px_current_x=b.clientX,_.px_current_y=b.clientY,_.px_tdelta_x=_.px_start_x-b.clientX,_.px_tdelta_y=_.px_start_y-b.clientY,l=Math.abs(_.px_tdelta_x)>u.px_radius||Math.abs(_.px_tdelta_y)>u.px_radius,_.timeStamp=b.timeStamp,l&&(_.do_allow_tap=!1,_.do_allow_held=!1),_.ms_elapsed>u.max_tap_ms&&(_.do_allow_tap=!1),r&&d&&(f===r||f===d)?(g[f]=_,c=g[r],x=g[d],p=Math.floor(Math.sqrt(Math.pow(c.px_current_x-x.px_current_x,2)+Math.pow(c.px_current_y-x.px_current_y,2))+.5),h=(c.px_current_x+x.px_current_x)/2,v=(c.px_current_y+x.px_current_y)/2,s=-1===y?0:(p-y)*X,y=p,w=!0):a===f&&i.uzoommove&&(s=_.px_delta_y*k,w=!0),w?(m=e.Event("uzoommove"),_.px_delta_zoom=s,_.px_center_x=h,_.px_center_y=v,e.extend(m,_),void e(_.elem_bound).trigger(m)):n===f?void(i.uheldmove&&(m=e.Event("uheldmove"),e.extend(m,_),e(_.elem_bound).trigger(m))):o===f?void(i.udragmove&&(m=e.Event("udragmove"),e.extend(m,_),e(_.elem_bound).trigger(m))):void(!i.udragstart||_.do_allow_tap!==!1||_.do_allow_held!==!1||o&&n||(o=f,m=e.Event("udragstart"),e.extend(m,_),e(_.elem_bound).trigger(m),_.tapheld_toid&&(clearTimeout(_.tapheld_toid),delete _.tapheld_toid)))},x=function(t){var _,u,i,l,m=t.motion_id,p=t.event_src,s=!1;z=!1,g[m]&&(_=g[m],u=_.option_map,i=u.bound_ns_map,_.elem_target=p.target,_.ms_elapsed=p.timeStamp-_.ms_timestart,_.ms_timestop=p.timeStamp,_.px_current_x&&(_.px_delta_x=p.clientX-_.px_current_x,_.px_delta_y=p.clientY-_.px_current_y),_.px_current_x=p.clientX,_.px_current_y=p.clientY,_.px_end_x=p.clientX,_.px_end_y=p.clientY,_.px_tdelta_x=_.px_start_x-_.px_end_x,_.px_tdelta_y=_.px_start_y-_.px_end_y,_.timeStamp=p.timeStamp,_.tapheld_toid&&(clearTimeout(_.tapheld_toid),delete _.tapheld_toid),i.utap&&_.ms_elapsed<=u.max_tap_ms&&_.do_allow_tap&&(l=e.Event("utap"),e.extend(l,_),e(_.elem_bound).trigger(l)),m===o&&(i.udragend&&(l=e.Event("udragend"),e.extend(l,_),e(_.elem_bound).trigger(l)),o=void 0),m===n&&(i.uheldend&&(l=e.Event("uheldend"),e.extend(l,_),e(_.elem_bound).trigger(l)),n=void 0),m===a?(s=!0,a=void 0):m===r&&(d?(r=d,d=void 0,s=!0):r=void 0,y=-1),m===d&&(d=void 0,y=-1,s=!0),s&&i.uzoomend&&(l=e.Event("uzoomend"),_.px_delta_zoom=0,e.extend(l,_),e(_.elem_bound).trigger(l)),delete g[m])},v=function(e){var t,_,o,n,a=this,r=+new Date,d=e.originalEvent,u=d?d.changedTouches||[]:[],i=u.length;switch(z=!0,e.timeStamp=r,e.type){case"touchstart":n=s;break;case"touchmove":n=c;break;case"touchend":case"touchcancel":n=x;break;default:n=null}if(n)for(t=0;i>t;t++)_=u[t],o="touch"+String(_.identifier),e.clientX=_.clientX,e.clientY=_.clientY,n({elem:a,motion_id:o,event_src:e})},h=function(e){var t,_=this,o="mouse"+String(e.button),n=!1;if(z)return void e.stopImmediatePropagation();if(e.shiftKey&&(n=!0),"mousemove"!==e.type&&0!==e.button)return!0;switch(e.type){case"mousedown":t=s;break;case"mouseup":t=x;break;case"mousemove":t=c;break;default:t=null}t&&t({elem:_,event_src:e,request_dzoom:n,motion_id:o})},f.ue=f.utap=f.uheld=f.uzoomstart=f.uzoommove=f.uzoomend=f.udragstart=f.udragmove=f.udragend=f.uheldstart=f.uheldmove=f.uheldend=_,e.ueSetGlobalCb=function(e,t,_){E.push({selector_str:e||"",callback_match:t||null,callback_nomatch:_||null})}}(jQuery);